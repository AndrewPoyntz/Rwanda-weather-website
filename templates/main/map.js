var page={init:function(){var e,t,n,r,i;r={theme:null,projection:new OpenLayers.Projection("EPSG:900913"),displayProjection:new OpenLayers.Projection("EPSG:4326"),controls:[new OpenLayers.Control.Navigation({dragPanOptions:{enableKinetic:true}}),new OpenLayers.Control.Attribution,new OpenLayers.Control.Zoom({zoomInId:"customZoomIn",zoomOutId:"customZoomOut"})]},i={DEFAULT_LNG:29.873888,DEFAULT_LAT:-1.940278,OVERALL_MAX_ZOOM:9,DEFAULT_ZOOM:8,MAP_TILES:new OpenLayers.Layer.OSM},control=new OpenLayers.Control;e=new OpenLayers.Map("map",r);e.addLayers([i.MAP_TILES,page.forecastLayer]);e.zoomToMaxExtent();e.setCenter((new OpenLayers.LonLat(i.DEFAULT_LNG,i.DEFAULT_LAT)).transform(e.displayProjection,e.projection),i.DEFAULT_ZOOM);e.addControl(control);$(document).bind("mousemove",function(e){$("#tooltip").css({left:e.pageX+15,top:e.pageY+15})});hoverControl=new OpenLayers.Control.SelectFeature(page.forecastLayer,{hover:true,highlightOnly:true,renderIntent:"temporary",eventListeners:{beforefeaturehighlighted:page.show_tooltip,featurehighlighted:page.show_tooltip,featureunhighlighted:page.hide_tooltip}});page.get_data();e.addControl(hoverControl);hoverControl.activate()},forecastLayer:new OpenLayers.Layer.Vector("Polygon Layer"),data:[],get_data:function(){page.data=$.parseJSON($("#mapData").html());if(page.data){page.loadMarkers("1")}},loadMarkers:function(e){page.forecastLayer.removeAllFeatures();var t=[],n,r,i,s=page.data;for(n=0;n<s.locations.length;n++){var o=s.locations[n];locationName=o.name;lat=o.lat;lon=o.lon;for(r=0;r<o.periods.length;r++){period=o.periods[r];if(period.id===e){for(i=0;i<period.detail.length;i++){detail=period.detail[i];text=detail.text+" <br>Max: "+detail.maxTemp+"&degc Min: "+detail.minTemp+"&degc <br>Wind: "+detail.windSpeed+" "+detail.windDirection;attributes={name:locationName,desc:text};var u={externalGraphic:"typo3conf/ext/forecastBackend/img/"+detail.icon,graphicWidth:48,graphicHeight:48,graphicYOffset:-24,graphicOpacity:0};marker=new OpenLayers.Geometry.Point(lon,lat);marker.transform(map.displayProjection,map.projection);page.forecastLayer.addFeatures([new OpenLayers.Feature.Vector(marker,attributes,u)])}}}}},show_tooltip:function(e){$("#tooltip").html("<h1>"+e.feature.attributes.name+"</h1><p>"+e.feature.attributes.desc+"</p>").show()},hide_tooltip:function(e){$("#tooltip").html("").hide()}};$(document).ready(function(){page.init()})
<?phpheader('Content-type: application/json');include 'conf.php';include $BACK_PATH."/init.php";function escape ($string) {	return $GLOBALS['TYPO3_DB']->quoteStr($string);}$result = array();$issue = strtotime($_POST['issue_time']);$issue_time = date('Y-m-d', $issue);$published = date('Y-m-d H:i:s');$headline = $_POST['headline'];$severe_weather = $_POST['severe_weather'];$insertArray = array(	'issue_time' => $issue_time,	'published' => $published,	'headline' => $headline,	'severe_weather' => $severe_weather);$create_forecast = $GLOBALS['TYPO3_DB']->exec_INSERTquery('forecasts', $insertArray);if ($create_forecast){	$forecast_id = $GLOBALS['TYPO3_DB']->sql_insert_id();	// loop through periods	$periods = $GLOBALS['TYPO3_DB']->exec_SELECTquery('*', 'forecast_periods');	while ($period = $GLOBALS['TYPO3_DB']->sql_fetch_assoc($periods)) {		$period_id = $period['id'];		// loop through locations		$locations = $GLOBALS['TYPO3_DB']->exec_SELECTquery('*', 'forecast_locations');		while ($location = $GLOBALS['TYPO3_DB']->sql_fetch_assoc($locations)) {			$location_id = $location['id'];			$beginning = $period_id . '_' . $location_id;			$insertArray = array(				'text' => escape($_POST[$beginning . 'text']),				'min_temp' => escape($_POST[$beginning . 'minTemp']),				'max_temp' => escape($_POST[$beginning . 'maxTemp']),				'wind_speed' => escape($_POST[$beginning . 'windSpeed']),				'wind_direction' => escape($_POST[$beginning . 'windDir']),				'icon_id' => escape($_POST[$beginning . 'icon']),				'forecast_id' => $forecast_id,				'location_id' => $location_id,				'period_id' => $period_id			);			$res = $GLOBALS['TYPO3_DB']->exec_INSERTquery('forecast_detail', $insertArray);		}	}}$result["result"] = true;echo json_encode($result);?>